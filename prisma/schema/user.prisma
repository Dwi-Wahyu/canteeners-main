model User {
    id String @id @default(uuid()) // jika role customer atau owner maka isi ini berupa firebase auth Uid

    role Role

    name     String
    username String? @unique
    password String?
    avatar   String  @default("avatars/default-avatar.jpg")

    messages      Message[]
    quick_chats   QuickChat[]
    conversations ConversationParticipant[]

    admin    Admin?
    customer Customer?
    owner    Owner?

    created_at DateTime  @default(now())
    updated_at DateTime  @updatedAt
    last_login DateTime?

    @@index([last_login])
    @@index([role])
    @@map("users")
}

enum Role {
    ADMIN
    CUSTOMER
    SHOP_OWNER
}

model Admin {
    id String @id @default(uuid())

    user    User   @relation(fields: [user_id], references: [id], onDelete: Cascade)
    user_id String @unique

    @@map("admins")
}

model Owner {
    id String @id @default(uuid())

    shop Shop?

    user    User   @relation(fields: [user_id], references: [id], onDelete: Cascade)
    user_id String @unique

    updated_at DateTime @updatedAt

    @@map("owners")
}

model Customer {
    id String @id @default(uuid())

    user    User   @relation(fields: [user_id], references: [id], onDelete: Cascade)
    user_id String @unique

    email        String?
    phone_number String?

    violations     CustomerViolation[]
    suspend_until  DateTime?
    suspend_reason String?

    orders Order[]
    cart   Cart?

    // Data posisi terakhir pilih meja
    canteen_id    Int?
    floor         Int?
    table_number  Int?
    last_visit_at DateTime?

    updated_at DateTime @updatedAt

    @@map("customers")
}
